#!/usr/bin/perl

use strict;
use warnings;
use Getopt::Long;
use Data::Dumper;

my $skip_first_line = undef ;
my $find_first_numeric_column = 1;
my $column_index = undef ;

my $result = GetOptions("header" => \$skip_first_line,
			"column=i" => \$column_index);

die "Bad command line arguments\n" unless $result;

# make "column_index" into zero-based index
$column_index-- if defined $column_index ;
# Turn off auto-detection, if column is specified on the command line
$find_first_numeric_column = 0 if defined $column_index;

sub nifty_number { defined $_[0] && $_[0] =~ /^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/; }

my $dummy=<> if $skip_first_line;

my $sum = 0 ;

while (<>) {
	chomp;
	my @fields = split /\t/;

	if ($find_first_numeric_column) {
		foreach my $i ( 0 .. $#fields ) {
			if (nifty_number($fields[$i])) {
				$find_first_numeric_column = 0 ;
				$column_index = $i ;
				last;
			}
		}
	}

	next unless defined $column_index;

	$sum += $fields[$column_index] if length($fields[$column_index]);
}

print $sum, "\n";
